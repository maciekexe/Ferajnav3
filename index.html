<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>FERAJNAV3 :: COMMAND CENTER</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;500;700&display=swap" rel="stylesheet">

</head>

<body class="p-4 md:p-8 crt-flicker">

<div class="fixed bottom-4 right-4 w-56 terminal p-2 text-[10px] z-50 bg-black shadow-2xl">
  <div class="flex justify-between border-b border-green-900 pb-1 mb-1">
    <span>CAM-03 (Baza G≈Ç√≥wna)</span>
    <span class="text-red-500 animate-pulse font-bold">‚óè REC</span>
  </div>
  <div class="relative bg-zinc-900 overflow-hidden h-24">
    <img onclick="changeCamera()"  class="opacity-50 grayscale contrast-125 w-full h-full object-cover">
    <div class="absolute inset-0 flex items-center justify-center opacity-20 pointer-events-none">NO SIGNAL</div>
  </div>
  <div class="mt-1 text-gray-500 flex justify-between">
    <span id="cctv-time">20:52:12</span>
    <span>X: ? Z: ?</span>
  </div>
</div>

<div class="max-w-5xl mx-auto">
  <header class="terminal p-8 mb-6 border-b-4 border-red-900">
    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="text-left">
        <h1 class="text-5xl md:text-7xl font-extrabold glitch-text text-red-600 tracking-tighter">FERAJNAV3</h1>
        <p class="text-green-500 opacity-80 uppercase tracking-widest text-xs mt-2">Sektor: DeceasedCraft // Protok√≥≈Ç: Survival</p>
      </div>
      <div class="text-right border-l border-green-900 pl-6 hidden md:block">
        <p class="text-xs text-gray-500">POZIOM ZAGRO≈ªENIA</p>
        <p class="text-2xl text-red-500 font-bold">KRYTYCZNY</p>
      </div>
    </div>
    
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 border-t border-green-900 pt-6">
      <div>
        <p class="text-xs text-gray-500 uppercase">Dni od wybuchu</p>
        <p class="text-2xl font-bold" id="days">0</p>
      </div>
      <div>
        <p class="text-xs text-gray-500 uppercase">Status Systemu</p>
        <p class="text-2xl font-bold text-green-400">ONLINE</p>
      </div>
      <div class="col-span-2">
        <p class="text-xs text-gray-500 uppercase">Wsp√≥≈Çrzƒôdne (IP)</p>
        <p class="text-xl font-bold text-red-400 cursor-pointer" onclick="copyIP()">ferajnav3.aternos.me</p>
      </div>
    </div>

    <div class="flex flex-wrap gap-4 mt-6">
      <button onclick="copyIP()" class="btn-tactical px-6 py-2 text-sm font-bold bg-red-900/20">Kopiuj IP</button>
      <button onclick="togglePower()" id="powerBtn" class="border border-green-500 px-6 py-2 text-sm font-bold text-green-500 hover:bg-green-500 hover:text-black">Zasilanie: OFF</button>
    </div>
  </header>

  <div class="grid md:grid-cols-3 gap-6">
    
    <div class="md:col-span-2 space-y-6">
      
      <section id="objective-section" class="terminal p-6 border-l-4 border-yellow-600">
  <div class="flex justify-between items-start mb-4">
    <h2 class="text-xl text-yellow-500 flex items-center tracking-tighter">
      <span class="mr-2 cursor-pointer" onclick="adminClick()">üîß</span> 
      OPERACJA: <span id="op-name">ODNOWA</span>
    </h2>
    <span class="text-[10px] bg-yellow-900/30 text-yellow-500 px-2 py-1 border border-yellow-900">FAZA: <span id="op-phase">2/4</span></span>
  </div>

  <div class="grid md:grid-cols-2 gap-6">
    <div class="space-y-4">
      <div class="flex justify-between text-[10px] mb-1 uppercase text-gray-400">
        <span>Integracja system√≥w</span>
        <span id="op-percent-text">65%</span>
      </div>
      <div class="w-full bg-zinc-900 h-3 border border-green-900 p-0.5">
        <div id="op-bar" class="bg-yellow-600 h-full shadow-[0_0_10px_#ca8a04] transition-all duration-1000" style="width:65%"></div>
      </div>

      <div class="text-[10px] border border-zinc-800 bg-black/40">
        <div class="grid grid-cols-3 border-b border-zinc-800 p-1 bg-zinc-900/50 text-gray-500 uppercase">
          <span>Przedmiot</span>
          <span class="text-center">Stan</span>
          <span class="text-right">Priorytet</span>
        </div>
        <div id="op-items-list" class="p-1 space-y-1">
          </div>
      </div>
    </div>

    <div class="relative group border border-zinc-800 p-1 bg-black">
      <p class="text-[9px] text-gray-600 mb-1">DATA_RECON: 2025-12-24_1200.IMG</p>
      <div class="overflow-hidden relative h-32">
        <img id="op-intel-img" src="https://i.imgur.com/K3V5qYV.jpeg" class="grayscale sepia(30%) contrast-125 opacity-40 hover:opacity-100 transition-opacity duration-500 w-full h-full object-cover">
        <div class="absolute inset-0 pointer-events-none border-[10px] border-black/20"></div>
      </div>
      <p id="op-intel-note" class="text-[10px] text-gray-500 mt-2 italic">"Wykryto wysokƒÖ aktywno≈õƒá w sektorze fabrycznym. Zalecana ostro≈ºno≈õƒá."</p>
    </div>
  </div>
</section>

      <section class="terminal p-6">
        <h2 class="text-xl text-red-500 mb-6 flex items-center">
          <span class="mr-2">üéØ</span> TABLICA ZLECE≈É (BOUNTY)
        </h2>
        <div class="grid sm:grid-cols-2 gap-4">
         
        </div>
      </section>

      <section class="terminal p-6">
        <h2 class="text-xl text-red-500 mb-4 flex items-center">
          <span class="mr-2">üìª</span> RADIO BROADCAST 77.4 MHz
        </h2>
        <div id="radioLog" class="h-64 overflow-y-auto space-y-2 mb-4 bg-black/50 p-4 border border-green-900/30 text-xs">
          </div>
      </section>
    </div>

    <div class="space-y-6">
      
      <section class="terminal p-6">
        <h2 class="text-xl text-red-500 mb-4">PROTOKO≈ÅY</h2>
        <ul class="text-xs space-y-4">
          <li class="flex items-start">
            <span class="mr-2 text-red-500 font-bold">01</span>
            <span>Wszystkie znaleziska z miast trafiajƒÖ do wsp√≥lnej skrzyni. <span class="redacted">Brak wyjƒÖtk√≥w.</span></span>
          </li>
          <li class="flex items-start">
            <span class="mr-2 text-red-500 font-bold">02</span>
            <span>Godzina policyjna: 20:00. Brama bazy musi byƒá zaryglowana.</span>
          </li>
          <li class="flex items-start">
            <span class="mr-2 text-red-500 font-bold">03</span>
            <span>Ugryziony cz≈Çonek Ferajny ma 5 minut na po≈ºegnanie siƒô.</span>
          </li>
        </ul>
      </section>

  
      <section class="terminal p-6 border-l-4 border-blue-500 mb-6">
  <h2 class="text-xl text-blue-400 mb-4 flex items-center">
    <span class="mr-2">üë•</span> AKTYWNI OCALALI
  </h2>
  <div id="player-status" class="mb-4">
    <p class="text-xs text-gray-500 uppercase">Status po≈ÇƒÖczenia:</p>
    <p id="server-status-text" class="text-lg font-bold">SKANOWANIE...</p>
  </div>
  <div id="player-list" class="space-y-2 text-sm">
    </div>
  <p id="player-count" class="text-[10px] text-gray-600 mt-4 uppercase"></p>
</section>

    </div>
  </div>
</div>

<footer class="mt-12 text-center text-[10px] text-gray-700 uppercase pb-12">
  W≈Çasno≈õƒá Ferajnav3 // Projekt: System Przetrwania v.0.84-B
</footer>

<audio id="powerSound" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_46f91c44f2.mp3" type="audio/mpeg">
</audio>

<script>
 // --- KONFIGURACJA ---
let lastPlayerList = [];
let adminCounter = 0;
const serverIP = "ferajnav3.aternos.me";

// Dane celu (Admin Panel)
const objectiveData = {
    name: "ODNOWA",
    phase: "2/4",
    percent: 65,
    items: [
        { name: "Cewki", status: "6/12", priority: "WYSOKI" },
        { name: "Stal", status: "44/128", priority: "≈öREDNI" },
        { name: "Rdze≈Ñ", status: "0/1", priority: "KRYTYCZNY" }
    ],
    note: "Szukajcie w fabrykach na zachodzie. Horda omija g≈Ç√≥wne wej≈õcie."
};

// --- SYSTEM POWIADOMIE≈É RADIOWYCH (LOGI) ---

function addSystemLog(msg, type = "INFO") {
    const saved = JSON.parse(localStorage.getItem('ferajnamessages') || '[]');
    const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    
    // Typy: JOIN (wej≈õcie), LEAVE (wyj≈õcie), ALARM (≈õmierƒá/horda), AMBIENT (klimat)
    const newMessage = { msg, type, time };
    saved.push(newMessage);
    
    if (saved.length > 30) saved.shift();
    localStorage.setItem('ferajnamessages', JSON.stringify(saved));
    renderRadio();
}

function renderRadio() {
    const saved = JSON.parse(localStorage.getItem('ferajnamessages') || '[]');
    const radioLog = document.getElementById("radioLog");
    
    radioLog.innerHTML = saved.map(m => {
        let style = "text-gray-400"; // Domy≈õlny kolor
        let prefix = "[INFO]";

        if (m.type === "JOIN") { style = "text-green-500"; prefix = "[SYGNA≈Å]"; }
        if (m.type === "LEAVE") { style = "text-yellow-600"; prefix = "[ZANIK]"; }
        if (m.type === "ALARM") { style = "text-red-600 font-bold animate-pulse"; prefix = "[ZAGRO≈ªENIE]"; }
        if (m.type === "AMBIENT") { style = "text-blue-400"; prefix = "[SKANER]"; }

        return `<div class="mb-2 border-b border-white/5 pb-1 leading-tight">
                    <span class="${style}">${prefix}</span> 
                    <span class="text-[9px] text-gray-600">${m.time}</span><br>
                    <span class="text-gray-300 text-[10px] uppercase">${m.msg}</span>
                </div>`;
    }).join('');
    
    radioLog.scrollTop = radioLog.scrollHeight;
}

// --- STATUS SERWERA I ≈öLEDZENIE GRACZY ---

async function refreshServerStatus() {
    const statusText = document.getElementById("server-status-text");
    const playerListDiv = document.getElementById("player-list");
    const playerCount = document.getElementById("player-count");

    try {
        const response = await fetch(`https://api.mcsrvstat.us/2/${serverIP}`);
        const data = await response.json();

        if (data.online) {
            statusText.innerText = "PO≈ÅƒÑCZENIE NAWIƒÑZANE";
            statusText.className = "text-lg font-bold text-green-400";
            
            const currentPlayers = data.players.list || [];

            // Wykrywanie Wej≈õƒá (JOIN)
            currentPlayers.forEach(p => {
                if (!lastPlayerList.includes(p)) {
                    addSystemLog(`OCALA≈ÅY ${p} NAWIƒÑZA≈Å PO≈ÅƒÑCZENIE ZE STACJƒÑ.`, "JOIN");
                }
            });

            // Wykrywanie Wyj≈õƒá/≈ömierci (LEAVE/DEATH)
            lastPlayerList.forEach(p => {
                if (!currentPlayers.includes(p)) {
                    const rand = Math.random();
                    if (rand > 0.5) {
                        addSystemLog(`UTRACONO TƒòTNO OCALA≈ÅEGO: ${p}. STATUS: KRYTYCZNY.`, "ALARM");
                    } else {
                        addSystemLog(`SYGNA≈Å OCALA≈ÅEGO ${p} WYGAS≈Å (OPU≈öCI≈Å STREFƒò).`, "LEAVE");
                    }
                }
            });

            lastPlayerList = currentPlayers;

            // Lista ocala≈Çych w UI
            if (currentPlayers.length > 0) {
                playerListDiv.innerHTML = currentPlayers.map(player => `
                    <div class="flex items-center gap-2 mb-1">
                        <img src="https://minotar.net/helm/${player}/16" alt="head" class="border border-green-900">
                        <span class="text-green-500 font-medium">${player}</span>
                        <span class="text-[8px] text-gray-600"> [AKTYWNY]</span>
                    </div>
                `).join('');
            } else {
                playerListDiv.innerHTML = "<p class='text-gray-600 italic'>CISZA W ETERZE...</p>";
            }
            playerCount.innerText = `Liczba ocala≈Çych: ${data.players.online}/${data.players.max}`;
        } else {
            statusText.innerText = "BRAK SYGNA≈ÅU (OFFLINE)";
            statusText.className = "text-lg font-bold text-red-600";
            playerListDiv.innerHTML = "<p class='text-red-900'>BAZA NIEAKTYWNA.</p>";
            playerCount.innerText = "";
        }
    } catch (error) {
        statusText.innerText = "B≈ÅƒÑD SKANERA";
    }
}

// --- LOGIKA CELU I ADMINA ---

function updateObjectiveUI() {
    document.getElementById('op-name').innerText = objectiveData.name;
    document.getElementById('op-phase').innerText = objectiveData.phase;
    document.getElementById('op-percent-text').innerText = objectiveData.percent + "%";
    document.getElementById('op-bar').style.width = objectiveData.percent + "%";
    document.getElementById('op-intel-note').innerText = `"${objectiveData.note}"`;

    const list = document.getElementById('op-items-list');
    list.innerHTML = objectiveData.items.map(item => `
        <div class="grid grid-cols-3 text-gray-300 py-0.5 border-b border-zinc-900/50">
            <span>‚ñ∏ ${item.name}</span>
            <span class="text-center text-yellow-600">${item.status}</span>
            <span class="text-right text-[9px] ${item.priority === 'KRYTYCZNY' ? 'text-red-600' : 'text-gray-500'}">${item.priority}</span>
        </div>
    `).join('');
}

function adminClick() {
    adminCounter++;
    if (adminCounter >= 3) {
        const pass = prompt("AUTORYZACJA:");
        if (pass === "ferajna") {
            objectiveData.name = prompt("OPERACJA:", objectiveData.name) || objectiveData.name;
            objectiveData.phase = prompt("FAZA:", objectiveData.phase) || objectiveData.phase;
            objectiveData.percent = prompt("PROCENT:", objectiveData.percent) || objectiveData.percent;
            objectiveData.note = prompt("NOTATKA:", objectiveData.note) || objectiveData.note;
            updateObjectiveUI();
        }
        adminCounter = 0;
    }
}

// --- CCTV, ZEGAR I ZASILANIE ---

setInterval(() => {
    document.getElementById('cctv-time').innerText = new Date().toLocaleTimeString();
}, 1000);

const startDay = new Date("2025-12-20");
document.getElementById("days").innerText = Math.floor((new Date() - startDay) / (1000 * 60 * 60 * 24));

const cctvImages = ["https://i.imgur.com/3ZQ3Z2U.gif", "https://i.imgur.com/K3V5qYV.jpeg", "https://i.imgur.com/8Km9tLL.png"];
let currentCam = 0;

function changeCamera() {
    const img = document.querySelector('.fixed img');
    currentCam = (currentCam + 1) % cctvImages.length;
    img.style.opacity = "0.1";
    setTimeout(() => { img.src = cctvImages[currentCam]; img.style.opacity = "0.5"; }, 150);
}

function togglePower() {
    const pwr = document.body.classList.toggle("power-on");
    const btn = document.getElementById("powerBtn");
    const audio = document.getElementById("powerSound");
    btn.innerText = pwr ? "Zasilanie: ON" : "Zasilanie: OFF";
    pwr ? (btn.classList.add("bg-green-500", "text-black"), audio.play()) : (btn.classList.remove("bg-green-500", "text-black"), audio.pause());
}

// --- LOSOWE WIADOMO≈öCI KLIMATYCZNE ---
setInterval(() => {
    const events = [
        {m: "WYKRYTO GWA≈ÅTOWNY WZROST AKTYWNO≈öCI NIEUMAR≈ÅYCH W SEKTORZE.", t: "ALARM"},
        {m: "SKANER BIOMEDYCZNY ZAREJESTROWA≈Å ZGON W POBLI≈ªU RUIN.", t: "ALARM"},
        {m: "PRZECHWYCONO KRZYK NA CZƒòSTOTLIWO≈öCI RATUNKOWEJ... CISZA.", t: "ALARM"},
        {m: "OSTRZE≈ªENIE: ATMOSFERYCZNE ZAK≈Å√ìCENIA UTRUDNIAJƒÑ SKANOWANIE.", t: "AMBIENT"},
        {m: "SYSTEM: POZIOM SKA≈ªENIA W NORMIE. PILNUJCIE MASEK.", t: "AMBIENT"}
    ];
    if (Math.random() > 0.7) {
        const e = events[Math.floor(Math.random() * events.length)];
        addSystemLog(e.m, e.t);
    }
}, 120000); // Co 2 minuty szansa na komunikat

// START
renderRadio();
updateObjectiveUI();
refreshServerStatus();
setInterval(refreshServerStatus, 30000);
</script>

</body>
</html>
